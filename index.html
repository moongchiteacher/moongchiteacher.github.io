<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>인터랙티브 하이러닝 수업 설계 가이드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #F9FAFB;
            color: #374151;
            line-height: 1.7;
            word-break: keep-all;
        }
        .nav-btn {
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
            color: #4B5563;
        }
        .nav-btn.active {
            color: #8B5CF6;
            border-bottom-color: #8B5CF6;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .competency-btn.active {
            background-color: #8B5CF6;
            color: white;
            transform: scale(1.05);
        }
        .feature-card {
            transition: all 0.3s ease;
            opacity: 0.5;
            filter: grayscale(80%);
        }
        .feature-card.highlight {
            opacity: 1;
            filter: grayscale(0%);
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        select:disabled, button:disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #8B5CF6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .ai-response-prose {
            color: #374151;
            line-height: 1.75;
            max-width: none;
        }
        .ai-response-prose p {
            margin-top: 0.75rem;
            margin-bottom: 0.75rem;
        }
        .ai-response-prose h4 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #5b21b6;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #ddd6fe;
        }
        .ai-response-prose ul {
            list-style-type: disc;
            margin-top: 1rem;
            margin-bottom: 1rem;
            padding-left: 1.75rem;
        }
        .ai-response-prose li {
            padding-left: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .ai-response-prose strong {
            color: #7c3aed;
            font-weight: 600;
        }
        .ai-response-prose hr {
            border-top: 1px solid #ddd6fe;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
        .ai-response-prose > *:first-child {
            margin-top: 0;
        }

        /* API 키 설정 모달 스타일 */
        .api-modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .api-modal-backdrop.show {
            visibility: visible;
            opacity: 1;
        }
        .api-modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .api-modal-backdrop.show .api-modal-content {
            transform: scale(1);
        }
        
        .api-status {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .api-status.configured {
            background-color: #dcfce7;
            color: #166534;
        }
        .api-status.not-configured {
            background-color: #fed7d7;
            color: #c53030;
        }
    </style>
</head>
<body>

    <!-- API 키 설정 모달 -->
    <div id="apiModalBackdrop" class="api-modal-backdrop">
        <div class="api-modal-content">
            <h2 class="text-2xl font-bold mb-4 text-gray-800">🔑 Gemini API 키 설정</h2>
            <p class="text-gray-600 mb-4 leading-relaxed">
                AI 기능을 사용하려면 Google Gemini API 키가 필요합니다. 
                API 키는 브라우저에만 저장되며 서버로 전송되지 않습니다.
            </p>
            
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
                <h3 class="font-semibold text-blue-800 mb-2">API 키 발급 방법:</h3>
                <ol class="list-decimal list-inside text-blue-700 space-y-1 text-sm">
                    <li><a href="https://aistudio.google.com/app/apikey" target="_blank" class="underline hover:text-blue-900">Google AI Studio</a>에 접속</li>
                    <li>"Create API Key" 버튼 클릭</li>
                    <li>생성된 API 키를 복사하여 아래에 입력</li>
                </ol>
            </div>

            <div class="mb-4">
                <label for="apiKeyInput" class="block mb-2 text-sm font-medium text-gray-900">API 키 입력</label>
                <input type="password" id="apiKeyInput" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500" placeholder="AIza...로 시작하는 API 키를 입력하세요">
            </div>

            <div class="flex gap-3">
                <button id="saveApiKeyBtn" class="flex-1 bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700 transition">저장</button>
                <button id="closeModalBtn" class="flex-1 bg-gray-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-600 transition">취소</button>
            </div>

            <div class="mt-4 text-xs text-gray-500">
                * API 키는 브라우저의 로컬 스토리지에만 저장되며, 페이지를 새로고침해도 유지됩니다.
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 md:py-16">
        <header class="text-center mb-12 md:mb-20">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-3">인터랙티브 하이러닝 수업 설계 가이드</h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">2022 개정 교육과정 기반, 학생 주도성을 깨우는 미래 수업을 AI와 함께 디자인하세요.</p>
            
            <!-- API 키 상태 표시 -->
            <div class="mt-6 flex justify-center">
                <div class="flex items-center gap-3">
                    <span id="apiStatusSpan" class="api-status not-configured">
                        🔑 AI 기능을 위해 API 키가 필요합니다
                    </span>
                    <button id="configureApiBtn" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition text-sm">
                        API 키 설정
                    </button>
                </div>
            </div>
        </header>

        <nav class="mb-12 border-b border-gray-200">
            <ul class="flex flex-wrap justify-center -mb-px text-lg font-medium text-center">
                <li><button class="nav-btn inline-block p-4 active" data-target="why">왜 하이러닝인가?</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="guides">수업 모델별 가이드</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="lesson-planner">성취기준별 설계</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="features">주요 기능 둘러보기</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="qna">AI Q&A</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="future">전략과 미래</button></li>
            </ul>
        </nav>

        <main>
            <section id="why" class="content-section active"></section>
            <section id="guides" class="content-section"></section>
            <section id="lesson-planner" class="content-section"></section>
            <section id="features" class="content-section"></section>
            <section id="qna" class="content-section"></section>
            <section id="future" class="content-section"></section>
        </main>

        <footer class="text-center mt-20 pt-10 border-t border-gray-200">
            <p class="text-sm text-gray-500">본 애플리케이션은 제공된 연구 보고서 및 교육과정 자료를 기반으로 제작된 대화형 가이드입니다.</p>
        </footer>
    </div>
    
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        console.log('페이지 로딩 시작');
        
        // --- API 키 관리 ---
        let apiKey = localStorage.getItem('gemini-api-key') || '';

        const updateApiStatus = () => {
            const apiStatus = document.getElementById('apiStatusSpan');
            const configureBtn = document.getElementById('configureApiBtn');
            
            if (apiKey) {
                apiStatus.textContent = '✅ API 키가 설정되었습니다';
                apiStatus.className = 'api-status configured';
                configureBtn.textContent = 'API 키 변경';
            } else {
                apiStatus.textContent = '🔑 AI 기능을 위해 API 키가 필요합니다';
                apiStatus.className = 'api-status not-configured';
                configureBtn.textContent = 'API 키 설정';
            }
        };

        const showApiModal = () => {
            const modal = document.getElementById('apiModalBackdrop');
            const input = document.getElementById('apiKeyInput');
            if (modal && input) {
                input.value = apiKey;
                modal.classList.add('show');
            }
        };

        const hideApiModal = () => {
            const modal = document.getElementById('apiModalBackdrop');
            if (modal) {
                modal.classList.remove('show');
            }
        };

        const saveApiKey = () => {
            const input = document.getElementById('apiKeyInput');
            const newApiKey = input.value.trim();
            
            if (newApiKey && newApiKey.startsWith('AIza')) {
                apiKey = newApiKey;
                localStorage.setItem('gemini-api-key', apiKey);
                updateApiStatus();
                hideApiModal();
                alert('API 키가 저장되었습니다!');
            } else {
                alert('올바른 Gemini API 키를 입력해주세요. (AIza로 시작해야 합니다)');
            }
        };

        const checkApiKey = () => {
            if (!apiKey) {
                alert('먼저 API 키를 설정해주세요.');
                showApiModal();
                return false;
            }
            return true;
        };

        // API 모달 이벤트 리스너 등록
        document.getElementById('configureApiBtn').addEventListener('click', showApiModal);
        document.getElementById('saveApiKeyBtn').addEventListener('click', saveApiKey);
        document.getElementById('closeModalBtn').addEventListener('click', hideApiModal);
        document.getElementById('apiKeyInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                saveApiKey();
            }
        });

        // 모달 외부 클릭 시 닫기
        document.getElementById('apiModalBackdrop').addEventListener('click', (e) => {
            if (e.target.id === 'apiModalBackdrop') {
                hideApiModal();
            }
        });

        updateApiStatus();

        // --- 기본 데이터 ---
        const lessonDesigns = {
            middleSchool: {
                "국어": {
                    "(듣기·말하기)": {
                        "[9국01-01]": { standard: "[9국01-01] 화자의 의도와 관점을 추론하며 듣는다." },
                        "[9국01-02]": { standard: "[9국01-02] 설득 전략을 비판적으로 분석하며 듣는다." }
                    },
                    "(읽기)": {
                        "[9국02-01]": { standard: "[9국02-01] 읽기는 사회·문화적 맥락에서 의미를 구성하는 과정임을 이해한다." }
                    }
                },
                "수학": {
                    "수와 연산": {
                        "[9수01-01]": { standard: "[9수01-01] 소인수분해의 뜻을 알고, 자연수를 소인수분해할 수 있다." }
                    }
                }
            },
            highSchool: {
                "공통국어": {
                    "(1) 듣기·말하기": {
                        "[10국01-01]": { standard: "[10국01-01] 듣기·말하기는 의미를 공유하고 상호 작용하는 활동임을 이해한다." }
                    }
                },
                "공통수학": {
                    "(1) 다항식": {
                        "[10공수1-01-01]": { standard: "[10공수1-01-01] 다항식의 사칙연산의 원리를 설명하고, 그 계산을 할 수 있다." }
                    }
                }
            }
        };
        
        const modelGuides = {
            inquiry: { 
                title: "질문하는 수업 (Inquiry-Based)", 
                description: "학생이 스스로 질문을 만들고 답을 찾아가는 과정을 통해 학생 주도성을 극대화하는 수업 모델입니다.", 
                steps: [
                    { title: "1단계: 탐구 시작하기", content: "교사는 수업의 도입부에서 학생들의 호기심을 자극할 만한 이미지, 짧은 영상, 혹은 정답이 없는 개방형 질문을 '통합학습창'에 제시합니다." }, 
                    { title: "2단계: 질문 생성하기", content: "학생들은 제시된 자료를 보고 떠오르는 질문들을 '수업 질문' 기능을 통해 실시간으로 교사에게 제출합니다." }
                ] 
            },
            process: { 
                title: "과정중심 수업 (Process-Focused)", 
                description: "결과물뿐만 아니라, 학습이 일어나는 전 과정을 평가하고 피드백함으로써 학생의 성장을 지원합니다.", 
                steps: [
                    { title: "1-2단계: 목표 공유 및 초기 진단", content: "교사는 단원의 시작에 학습 목표와 평가 기준(루브릭)을 '통합학습창'에 공지합니다." }
                ] 
            }
        };

        // AI 응답 포맷팅 함수
        const formatAiResponseToHtml = (text) => {
            return text
                .replace(/^### (.*$)/gm, '<h4>$1</h4>')
                .replace(/^---$/gm, '<hr>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/((?:(?:^|\n)\* .*(?:\n|$))+)/gm, (match) => {
                    const items = match.trim().split('\n')
                        .map(line => `<li>${line.substring(line.indexOf('*') + 1).trim()}</li>`)
                        .join('');
                    return `<ul>${items}</ul>`;
                })
                .split('\n')
                .map(line => {
                    const trimmedLine = line.trim();
                    if (!trimmedLine) return ''; 
                    if (trimmedLine.startsWith('<h4') || trimmedLine.startsWith('<ul') || trimmedLine.startsWith('<hr')) {
                        return line;
                    }
                    return `<p>${trimmedLine}</p>`;
                })
                .join('')
                .replace(/<p><ul>/g, '<ul>')
                .replace(/<\/ul><\/p>/g, '</ul>');
        };

        // Gemini API 호출 함수
        const callGeminiAPI = async (prompt) => {
            if (!checkApiKey()) return null;
            
            try {
                const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    throw new Error("응답 형식이 올바르지 않습니다.");
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                throw error;
            }
        };

        // 메인 설정 함수
        const setupAll = () => {
            console.log('setupAll 실행');
            setupStaticContent();
            setupWhySection();
            setupNavigation();
        };
        
        // 정적 콘텐츠 설정
        const setupStaticContent = () => {
            const featuresSection = document.getElementById('features');
            if (featuresSection) {
                featuresSection.innerHTML = `
                <h2 class="text-3xl font-bold text-center mb-4">주요 기능 둘러보기</h2>
                <p class="max-w-3xl mx-auto text-center text-gray-600 mb-10 leading-relaxed">
                    하이러닝은 교사를 '학습 경험 설계자'로 만들어주는 강력한 도구 모음입니다.
                </p>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition">
                        <h3 class="font-bold text-xl mb-2 text-purple-700">AI 기반 맞춤 학습</h3>
                        <p class="text-gray-600 leading-relaxed">AI가 학생의 지식 수준을 진단하고, 개인별 최적의 학습 경로를 제공합니다.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition">
                        <h3 class="font-bold text-xl mb-2 text-purple-700">수업 설계 및 관리</h3>
                        <p class="text-gray-600 leading-relaxed">교사는 자신의 수업 자료를 등록·공유하고, 동료 교사의 우수한 수업 설계안을 활용할 수 있습니다.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition">
                        <h3 class="font-bold text-xl mb-2 text-purple-700">상호작용 수업 도구</h3>
                        <p class="text-gray-600 leading-relaxed">통합학습창 내 화이트보드, 설문, 퀴즈, 발표 등의 기능으로 역동적인 수업을 만들 수 있습니다.</p>
                    </div>
                </div>`;
            }
            
            const futureSection = document.getElementById('future');
            if (futureSection) {
                futureSection.innerHTML = `
                <h2 class="text-3xl font-bold text-center mb-4">전략적 실행과 미래 전망</h2>
                <p class="max-w-3xl mx-auto text-center text-gray-600 mb-12 leading-relaxed">하이러닝의 성공적인 도입은 기술적 숙달을 넘어, 교육 철학에 기반한 전략적 접근이 필요합니다.</p>
                <div class="grid md:grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg border-l-4 border-red-400">
                        <h3 class="font-bold text-xl mb-3">⚠️ 도전 과제</h3>
                        <p class="text-gray-700">데이터 프라이버시, 디지털 격차, 교사 역량 개발 등의 과제가 있습니다.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg border-l-4 border-green-400">
                        <h3 class="font-bold text-xl mb-3">🚀 성공 전략</h3>
                        <p class="text-gray-700">비전 중심의 리더십, 협력적 문화 구축, 점진적 접근이 필요합니다.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg border-l-4 border-blue-400">
                        <h3 class="font-bold text-xl mb-3">🛰️ 미래 전망</h3>
                        <p class="text-gray-700">국가 AIDT와 연동되어 통합된 학습 생태계를 구축할 예정입니다.</p>
                    </div>
                </div>`;
            }
        };

        // Why 섹션 설정
        const setupWhySection = () => {
            const whySection = document.getElementById('why');
            if (!whySection) return;

            whySection.innerHTML = `
            <div class="space-y-16 md:space-y-24">
                <div>
                    <h2 class="text-3xl font-bold text-center mb-4">교육의 패러다임 전환: 2015 vs 2022</h2>
                    <p class="max-w-3xl mx-auto text-center text-gray-600 mb-10 leading-relaxed">
                        2015 개정 교육과정이 '역량'의 씨앗을 심었다면, 2022 개정 교육과정은 학생이 학습의 주인이 되는 '학생 주도성'의 꽃을 피우려 합니다.
                    </p>
                    <div class="chart-container"><canvas id="curriculumRadarChart"></canvas></div>
                    <div class="flex justify-center items-center gap-4 mt-6">
                        <button id="show2015Chart" class="bg-orange-400 text-white font-semibold py-2 px-5 rounded-full hover:bg-orange-500 transition">2015 교육과정</button>
                        <button id="show2022Chart" class="bg-purple-500 text-white font-semibold py-2 px-5 rounded-full hover:bg-purple-600 transition">2022 교육과정</button>
                        <button id="resetChart" class="bg-gray-500 text-white font-semibold py-2 px-5 rounded-full hover:bg-gray-600 transition">초기화</button>
                    </div>
                </div>
                <div>
                    <h2 class="text-3xl font-bold text-center mb-4">핵심역량과 하이러닝의 연결</h2>
                    <p class="max-w-3xl mx-auto text-center text-gray-600 mb-10 leading-relaxed">
                        2022 개정 교육과정이 제시하는 6대 핵심역량은 어떻게 길러질 수 있을까요? 아래 역량을 클릭하여 관련된 하이러닝의 핵심 기능들을 탐색해 보세요.
                    </p>
                    <div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8">
                        <button class="competency-btn transition-all duration-300 ease-in-out text-sm md:text-base bg-white shadow-md hover:bg-purple-600 hover:text-white font-semibold py-2 px-4 border border-gray-200 rounded-full" data-competency="community">공동체 역량</button>
                    </div>
                    <div id="competency-description" class="p-6 bg-purple-50 border-l-4 border-purple-500 text-purple-800 rounded-r-lg min-h-[100px] flex items-center justify-center transition-all duration-300 ease-in-out">
                        <p class="text-center">궁금한 핵심역량을 클릭해 주세요.</p>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-10">
                        <div class="feature-card bg-white p-4 rounded-lg shadow-md" data-feature="self-management knowledge-info">
                            <h3 class="font-bold">AI 학습 진단/리포트</h3>
                            <p class="text-sm text-gray-600">학습 현황 분석으로<br>목표 설정을 돕습니다.</p>
                        </div>
                        <div class="feature-card bg-white p-4 rounded-lg shadow-md" data-feature="knowledge-info">
                            <h3 class="font-bold">AI 콘텐츠 추천/챗봇</h3>
                            <p class="text-sm text-gray-600">정보 탐색, 평가, 종합<br>능력을 지원합니다.</p>
                        </div>
                        <div class="feature-card bg-white p-4 rounded-lg shadow-md" data-feature="creative-thinking collaborative-communication">
                            <h3 class="font-bold">통합학습창(화이트보드)</h3>
                            <p class="text-sm text-gray-600">아이디어 브레인스토밍 및<br>문제 해결을 돕습니다.</p>
                        </div>
                        <div class="feature-card bg-white p-4 rounded-lg shadow-md" data-feature="self-management">
                            <h3 class="font-bold">오답 노트</h3>
                            <p class="text-sm text-gray-600">실수 성찰과 메타인지<br>능력을 기릅니다.</p>
                        </div>
                        <div class="feature-card bg-white p-4 rounded-lg shadow-md" data-feature="creative-thinking">
                            <h3 class="font-bold">AI 논술 진단</h3>
                            <p class="text-sm text-gray-600">논리적 주장과 창의적<br>표현력을 향상시킵니다.</p>
                        </div>
                        <div class="feature-card bg-white p-4 rounded-lg shadow-md" data-feature="aesthetic-emotional community collaborative-communication">
                            <h3 class="font-bold">우리반 게시판/클래스보드</h3>
                            <p class="text-sm text-gray-600">결과물 공유와<br>상호작용으로 소통합니다.</p>
                        </div>
                        <div class="feature-card bg-white p-4 rounded-lg shadow-md" data-feature="collaborative-communication">
                            <h3 class="font-bold">실시간 설문/퀴즈</h3>
                            <p class="text-sm text-gray-600">모든 학생의 참여를 유도하고<br>의견을 수렴합니다.</p>
                        </div>
                        <div class="feature-card bg-white p-4 rounded-lg shadow-md" data-feature="community collaborative-communication">
                            <h3 class="font-bold">모둠 활동</h3>
                            <p class="text-sm text-gray-600">의견 조율과 건설적<br>피드백을 경험합니다.</p>
                        </div>
                    </div>
                </div>
            </div>`;

            // 차트 설정
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    setupChart();
                } else {
                    console.warn('Chart.js가 로드되지 않았습니다.');
                }
                setupCompetencyButtons();
            }, 500);
        };

        // 차트 설정 함수
        const setupChart = () => {
            const chartEl = document.getElementById('curriculumRadarChart');
            if (!chartEl) return;
            
            try {
                const ctx = chartEl.getContext('2d');
                
                const data2015 = { label: '2015 개정 교육과정', data: [4, 3, 3, 2, 3, 2], backgroundColor: 'rgba(251, 146, 60, 0.2)', borderColor: 'rgb(251, 146, 60)', borderWidth: 2, pointBackgroundColor: 'rgb(251, 146, 60)' };
                const data2022 = { label: '2022 개정 교육과정', data: [5, 5, 5, 4, 5, 4], backgroundColor: 'rgba(139, 92, 246, 0.2)', borderColor: 'rgb(139, 92, 246)', borderWidth: 2, pointBackgroundColor: 'rgb(139, 92, 246)' };
                const labels = ['추구하는 인간상', '핵심역량 초점', '핵심 교육 용어', '디지털 교육', '평가 패러다임', '학교 자율성'];

                const chart = new Chart(ctx, {
                    type: 'radar',
                    data: { labels: labels, datasets: [] },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                                grid: { color: 'rgba(0, 0, 0, 0.1)' },
                                pointLabels: { font: { size: 12 }, color: '#374151' },
                                ticks: { stepSize: 1, backdropColor: 'rgba(255, 255, 255, 0.7)', color: '#6b7280' },
                                suggestedMin: 0,
                                suggestedMax: 5
                            }
                        },
                        plugins: { legend: { labels: { font: { size: 14 } } } }
                    }
                });

                document.getElementById('show2015Chart')?.addEventListener('click', () => {
                    const exists = chart.data.datasets.some(ds => ds.label === data2015.label);
                    if (!exists) {
                        chart.data.datasets.push(data2015);
                        chart.update();
                    }
                });

                document.getElementById('show2022Chart')?.addEventListener('click', () => {
                    const exists = chart.data.datasets.some(ds => ds.label === data2022.label);
                    if (!exists) {
                        chart.data.datasets.push(data2022);
                        chart.update();
                    }
                });
                
                document.getElementById('resetChart')?.addEventListener('click', () => {
                    chart.data.datasets = [];
                    chart.update();
                });
                
            } catch (error) {
                console.error('차트 생성 오류:', error);
            }
        };

        // 핵심역량 버튼 설정
        const setupCompetencyButtons = () => {
            const competencyBtns = document.querySelectorAll('.competency-btn');
            const featureCards = document.querySelectorAll('.feature-card');
            const competencyDesc = document.getElementById('competency-description');
            
            const descriptions = { 
                'self-management': "AI 리포트, 오답 노트 등으로 자신의 학습 현황을 점검하고, 학습 목표를 설정하며 자기주도적 학습 능력을 기릅니다.", 
                'knowledge-info': "AI 콘텐츠 추천, 챗봇 등을 활용하여 다양한 정보를 비판적으로 탐색, 평가, 종합하는 능력을 훈련합니다.", 
                'creative-thinking': "통합학습창의 화이트보드, 발표 기능 등을 활용하여 아이디어를 발상하고 구체화하며 창의성을 발현합니다.", 
                'aesthetic-emotional': "다양한 매체로 자신의 생각과 감정을 표현하고, 클래스보드나 게시판에서 타인의 감성에 공감하는 능력을 키웁니다.", 
                'collaborative-communication': "통합학습창의 모둠 활동, 실시간 설문/퀴즈, 클래스보드 등을 통해 의견을 조율하고 공동의 목표를 달성하는 협력적 문제 해결을 경험합니다.", 
                'community': "게시판 토론, 클래스보드 동료 피드백을 통해 학급 공동체의 학습에 기여하며 민주 시민 의식을 함양합니다."
            };
            
            competencyBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetCompetency = btn.dataset.competency;
                    
                    if (btn.classList.contains('active')) {
                        btn.classList.remove('active');
                        featureCards.forEach(card => card.classList.remove('highlight'));
                        competencyDesc.innerHTML = `<p class="text-center">궁금한 핵심역량을 클릭해 주세요.</p>`;
                    } else {
                        competencyBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        competencyDesc.innerHTML = `<p>${descriptions[targetCompetency]}</p>`;
                        featureCards.forEach(card => {
                            if (card.dataset.feature && card.dataset.feature.includes(targetCompetency)) {
                                card.classList.add('highlight');
                            } else {
                                card.classList.remove('highlight');
                            }
                        });
                    }
                });
            });
        };

        // 네비게이션 설정
        const setupNavigation = () => {
            const navBtns = document.querySelectorAll('.nav-btn');
            const contentSections = document.querySelectorAll('.content-section');
            
            navBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    navBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    contentSections.forEach(section => {
                        section.classList.toggle('active', section.id === btn.dataset.target);
                    });
                });
            });
        };

        // 모든 설정 실행
        setupAll();
        console.log('페이지 로딩 완료');

    });
    </script>
</body>
</html>all duration-300 ease-in-out text-sm md:text-base bg-white shadow-md hover:bg-purple-600 hover:text-white font-semibold py-2 px-4 border border-gray-200 rounded-full" data-competency="self-management">자기관리 역량</button>
                        <button class="competency-btn transition-all duration-300 ease-in-out text-sm md:text-base bg-white shadow-md hover:bg-purple-600 hover:text-white font-semibold py-2 px-4 border border-gray-200 rounded-full" data-competency="knowledge-info">지식정보처리 역량</button>
                        <button class="competency-btn transition-all duration-300 ease-in-out text-sm md:text-base bg-white shadow-md hover:bg-purple-600 hover:text-white font-semibold py-2 px-4 border border-gray-200 rounded-full" data-competency="creative-thinking">창의적 사고 역량</button>
                        <button class="competency-btn transition-all duration-300 ease-in-out text-sm md:text-base bg-white shadow-md hover:bg-purple-600 hover:text-white font-semibold py-2 px-4 border border-gray-200 rounded-full" data-competency="aesthetic-emotional">심미적 감성 역량</button>
                        <button class="competency-btn transition-all duration-300 ease-in-out text-sm md:text-base bg-white shadow-md hover:bg-purple-600 hover:text-white font-semibold py-2 px-4 border border-gray-200 rounded-full" data-competency="collaborative-communication">협력적 소통 역량</button>
                        <button class="competency-btn transition-

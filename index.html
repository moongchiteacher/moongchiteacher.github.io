<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>인터랙티브 하이러닝 수업 설계 가이드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #F9FAFB;
            color: #374151;
            line-height: 1.7;
            word-break: keep-all;
        }
        .nav-btn {
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
            color: #4B5563;
        }
        .nav-btn.active {
            color: #8B5CF6;
            border-bottom-color: #8B5CF6;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .competency-btn.active {
            background-color: #8B5CF6;
            color: white;
            transform: scale(1.05);
        }
        .feature-card {
            transition: all 0.3s ease;
            opacity: 0.5;
            filter: grayscale(80%);
        }
        .feature-card.highlight {
            opacity: 1;
            filter: grayscale(0%);
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        select:disabled, button:disabled {
            background-color: #e9ecef;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #8B5CF6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .ai-response-prose {
            color: #374151;
            line-height: 1.75;
            max-width: none;
        }
        .ai-response-prose p {
            margin-top: 0.75rem;
            margin-bottom: 0.75rem;
        }
        .ai-response-prose h4 {
            font-size: 1.25rem;
            font-weight: 700;
            color: #5b21b6;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #ddd6fe;
        }
        .ai-response-prose ul {
            list-style-type: disc;
            margin-top: 1rem;
            margin-bottom: 1rem;
            padding-left: 1.75rem;
        }
        .ai-response-prose li {
            padding-left: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .ai-response-prose strong {
            color: #7c3aed;
            font-weight: 600;
        }
        .ai-response-prose hr {
            border-top: 1px solid #ddd6fe;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
        .ai-response-prose > *:first-child {
            margin-top: 0;
        }

        /* API 키 설정 모달 스타일 */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
        }
        .modal.active {
            display: flex !important;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .api-status {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .api-status.configured {
            background-color: #dcfce7;
            color: #166534;
        }
        .api-status.not-configured {
            background-color: #fed7d7;
            color: #c53030;
        }

    </style>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
</head>
<body class="antialiased">

    <!-- API 키 설정 모달 -->
    <div id="api-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-4 text-gray-800">🔑 Gemini API 키 설정</h2>
            <p class="text-gray-600 mb-4 leading-relaxed">
                AI 기능을 사용하려면 Google Gemini API 키가 필요합니다. 
                API 키는 브라우저에만 저장되며 서버로 전송되지 않습니다.
            </p>
            
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
                <h3 class="font-semibold text-blue-800 mb-2">API 키 발급 방법:</h3>
                <ol class="list-decimal list-inside text-blue-700 space-y-1 text-sm">
                    <li><a href="https://aistudio.google.com/app/apikey" target="_blank" class="underline hover:text-blue-900">Google AI Studio</a>에 접속</li>
                    <li>"Create API Key" 버튼 클릭</li>
                    <li>생성된 API 키를 복사하여 아래에 입력</li>
                </ol>
            </div>

            <div class="mb-4">
                <label for="api-key-input" class="block mb-2 text-sm font-medium text-gray-900">API 키 입력</label>
                <input type="password" id="api-key-input" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500" placeholder="AIza...로 시작하는 API 키를 입력하세요">
            </div>

            <div class="flex gap-3">
                <button id="save-api-key" class="flex-1 bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700 transition">저장</button>
                <button id="close-modal" class="flex-1 bg-gray-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-600 transition">취소</button>
            </div>

            <div class="mt-4 text-xs text-gray-500">
                * API 키는 브라우저의 로컬 스토리지에만 저장되며, 페이지를 새로고침해도 유지됩니다.
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 md:py-16">
        <header class="text-center mb-12 md:mb-20">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-3">인터랙티브 하이러닝 수업 설계 가이드</h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">2022 개정 교육과정 기반, 학생 주도성을 깨우는 미래 수업을 AI와 함께 디자인하세요.</p>
            
            <!-- API 키 상태 표시 -->
            <div class="mt-6 flex justify-center">
                <div class="flex items-center gap-3">
                    <span id="api-status" class="api-status not-configured">
                        🔑 AI 기능을 위해 API 키가 필요합니다
                    </span>
                    <button id="configure-api" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition text-sm">
                        API 키 설정
                    </button>
                </div>
            </div>
        </header>

        <nav class="mb-12 border-b border-gray-200">
            <ul class="flex flex-wrap justify-center -mb-px text-lg font-medium text-center">
                <li><button class="nav-btn inline-block p-4 active" data-target="why">왜 하이러닝인가?</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="guides">수업 모델별 가이드</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="lesson-planner">성취기준별 설계</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="features">주요 기능 둘러보기</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="qna">AI Q&A</button></li>
                <li><button class="nav-btn inline-block p-4" data-target="future">전략과 미래</button></li>
            </ul>
        </nav>

        <main>
            <section id="why" class="content-section active"></section>
            <section id="guides" class="content-section"></section>
            <section id="lesson-planner" class="content-section"></section>
            <section id="features" class="content-section"></section>
            <section id="qna" class="content-section"></section>
            <section id="future" class="content-section"></section>
        </main>

        <footer class="text-center mt-20 pt-10 border-t border-gray-200">
            <p class="text-sm text-gray-500">본 애플리케이션은 제공된 연구 보고서 및 교육과정 자료를 기반으로 제작된 대화형 가이드입니다.</p>
        </footer>
    </div>
    
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- API 키 관리 ---
        let apiKey = localStorage.getItem('gemini-api-key') || '';

        const updateApiStatus = () => {
            const apiStatus = document.getElementById('api-status');
            const configureBtn = document.getElementById('configure-api');
            
            if (apiKey) {
                apiStatus.textContent = '✅ API 키가 설정되었습니다';
                apiStatus.className = 'api-status configured';
                configureBtn.textContent = 'API 키 변경';
            } else {
                apiStatus.textContent = '🔑 AI 기능을 위해 API 키가 필요합니다';
                apiStatus.className = 'api-status not-configured';
                configureBtn.textContent = 'API 키 설정';
            }
        };

        const showApiModal = () => {
            console.log('API 모달 열기'); // 디버깅용
            const modal = document.getElementById('api-modal');
            const input = document.getElementById('api-key-input');
            if (modal && input) {
                input.value = apiKey;
                modal.classList.add('active');
                console.log('모달 클래스 추가됨'); // 디버깅용
            } else {
                console.error('모달 또는 입력 요소를 찾을 수 없습니다');
            }
        };

        const hideApiModal = () => {
            console.log('API 모달 닫기'); // 디버깅용
            const modal = document.getElementById('api-modal');
            if (modal) {
                modal.classList.remove('active');
            }
        };

        const saveApiKey = () => {
            const input = document.getElementById('api-key-input');
            const newApiKey = input.value.trim();
            
            if (newApiKey && newApiKey.startsWith('AIza')) {
                apiKey = newApiKey;
                localStorage.setItem('gemini-api-key', apiKey);
                updateApiStatus();

        // 디버깅: 요소들이 제대로 로드되었는지 확인
        console.log('API 모달:', document.getElementById('api-modal'));
        console.log('설정 버튼:', document.getElementById('configure-api'));
        console.log('API 키:', apiKey);
                hideApiModal();
                alert('API 키가 저장되었습니다!');
            } else {
                alert('올바른 Gemini API 키를 입력해주세요. (AIza로 시작해야 합니다)');
            }
        };

        const checkApiKey = () => {
            if (!apiKey) {
                alert('먼저 API 키를 설정해주세요.');
                showApiModal();
                return false;
            }
            return true;
        };

        // 이벤트 리스너 등록
        document.getElementById('configure-api').addEventListener('click', (e) => {
            e.preventDefault();
            showApiModal();
        });
        document.getElementById('save-api-key').addEventListener('click', (e) => {
            e.preventDefault();
            saveApiKey();
        });
        document.getElementById('close-modal').addEventListener('click', (e) => {
            e.preventDefault();
            hideApiModal();
        });
        document.getElementById('api-key-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                saveApiKey();
            }
        });

        // 모달 외부 클릭 시 닫기
        document.getElementById('api-modal').addEventListener('click', (e) => {
            if (e.target.id === 'api-modal') {
                hideApiModal();
            }
        });

        updateApiStatus();

        // --- 기존 데이터 (2022 개정 교육과정 성취기준) ---
        const lessonDesigns = {
            middleSchool: {
                "국어": {
                    "(듣기·말하기)": {
                        "[9국01-01]": { standard: "[9국01-01] 화자의 의도와 관점을 추론하며 듣는다." },
                        "[9국01-02]": { standard: "[9국01-02] 설득 전략을 비판적으로 분석하며 듣는다." },
                        "[9국01-03]": { standard: "[9국01-03] 담화 공동체에 따른 듣기·말하기 방식의 다양성을 고려하여 듣고 말한다." },
                        "[9국01-04]": { standard: "[9국01-04] 상대의 말을 경청하고 상대의 감정과 입장에 공감하는 반응을 보이며 대화한다." },
                        "[9국01-05]": { standard: "[9국01-05] 면담의 다양한 목적과 상대를 고려하여 질문을 점검하고 효과적으로 면담한다." },
                        "[9국01-06]": { standard: "[9국01-06] 다양한 자료를 재구성하여 내용을 체계적으로 조직하고 청중이 이해하기 쉽게 발표한다." },
                        "[9국01-07]": { standard: "[9국01-07] 토의에서 다양한 의견을 교환하여 대안을 마련하고 문제를 해결한다." },
                        "[9국01-08]": { standard: "[9국01-08] 토론에서 반론을 고려하여 타당한 논증을 구성하고 논리적으로 반박한다." },
                        "[9국01-09]": { standard: "[9국01-09] 서로의 감정이나 바라는 바를 진솔하게 표현하면서 갈등을 조정한다." },
                        "[9국01-10]": { standard: "[9국01-10] 언어폭력의 문제점을 성찰하고, 서로를 존중하는 표현을 사용하여 말한다." },
                        "[9국01-11]": { standard: "[9국01-11] 듣기·말하기 과정을 점검하고 듣기·말하기의 어려움을 효과적으로 조정한다." }
                    },
                    "(읽기)": {
                        "[9국02-01]": { standard: "[9국02-01] 읽기는 사회·문화적 맥락에서 의미를 구성하는 과정임을 이해하며 사회적 독서에 참여하고 사회적 독서 문화 형성에 기여한다." },
                        "[9국02-02]": { standard: "[9국02-02] 읽기 목적과 글의 구조를 고려하며 글을 효과적으로 요약한다." },
                        "[9국02-03]": { standard: "[9국02-03] 독자의 배경지식과 글에 나타난 정보 등을 활용하여 글에 드러나지 않은 의도나 관점을 추론하며 읽는다." },
                        "[9국02-05]": { standard: "[9국02-05] 글에 사용된 다양한 설명 방법과 논증 방법을 파악하고, 그 타당성을 평가하며 읽는다." },
                        "[9국02-06]": { standard: "[9국02-06] 동일한 화제를 다룬 여러 글이나 자료를 주제 통합적으로 읽는다." },
                        "[9국02-07]": { standard: "[9국02-07] 진로나 관심 분야에 대한 다양한 책이나 자료를 스스로 찾아 읽는다." },
                        "[9국02-08]": { standard: "[9국02-08] 자신의 독서 상황과 수준에 맞는 글을 선정하고 읽기 과정을 점검·조정하며 읽는다." }
                    },
                     "(쓰기)": {
                        "[9국03-01]": { standard: "[9국03-01] 대상의 특성에 적합한 설명 방법을 활용하여 글을 쓴다." },
                        "[9국03-02]": { standard: "[9국03-02] 복수의 자료를 활용하여 다양한 형식으로 정보를 전달하는 글을 쓴다." },
                        "[9국03-03]": { standard: "[9국03-03] 주장을 뒷받침할 수 있는 타당한 근거를 들고 적절한 표현을 사용하여 주장하는 글을 쓴다." },
                        "[9국03-05]": { standard: "[9국03-05] 자신의 삶과 경험을 바탕으로 정서를 진솔하게 표현하는 글을 쓴다." },
                        "[9국03-08]": { standard: "[9국03-08] 쓰기 과정을 점검·조정하며 글을 쓰고, 독자를 고려하여 글을 고쳐 쓴다." },
                    },
                    "(문법)": {
                        "[9국04-01]": { standard: "[9국04-01] 국어의 음운 체계와 문자 체계를 이해하고 국어생활에 활용한다." },
                        "[9국04-02]": { standard: "[9국04-02] 단어의 짜임을 분석하여 새말 형성의 원리를 이해한다." },
                        "[9국04-03]": { standard: "[9국04-03] 품사의 종류와 특성을 이해하고 국어 자료를 분석한다." },
                        "[9국04-04]": { standard: "[9국04-04] 문장의 짜임을 이해하고 표현 효과를 고려하여 문장을 구성한다." }
                    },
                    "(문학)": {
                        "[9국05-01]": { standard: "[9국05-01] 운율, 비유, 상징의 특성과 효과에 유의하며 작품을 감상하고 창작한다." },
                        "[9국05-02]": { standard: "[9국05-02] 서사 갈래에서 서술자의 역할과 효과를 파악하고 작품을 감상한다." },
                        "[9국05-05]": { standard: "[9국05-05] 작품에 반영된 사회·문화적 상황을 이해하며 작품을 감상한다." },
                    }
                },
                "사회": {
                     "(1) 개인과 사회생활": {
                        "[9사(일사)01-01]": { standard: "[9사(일사)01-01] 사회화의 의미를 일상생활의 사례를 들어 설명하고, 사회화 과정에서 형성되는 자아 정체성에 대해 성찰한다." },
                        "[9사(일사)01-02]": { standard: "[9사(일사)01-02] 사회적 지위와 역할의 의미를 설명하고, 일상생활에서 나타나는 역할 갈등 사례와 대응 방안을 탐색한다." },
                        "[9사(일사)01-03]": { standard: "[9사(일사)01-03] 사회 집단과 사회 조직의 의미와 유형을 비교하고, 개인과 사회의 관계를 탐색한다." },
                        "[9사(일사)01-04]": { standard: "[9사(일사)01-04] 사회 변동의 의미와 특징을 이해하고, 현대사회의 다양한 사회 변동 양상을 분석한다." },
                    },
                    "(2) 문화": {
                        "[9사(일사)02-01]": { standard: "[9사(일사)02-01] 일상생활에서 접하는 문화의 사례를 탐색하고, 이를 바탕으로 문화의 의미와 특징을 도출한다." },
                        "[9사(일사)02-02]": { standard: "[9사(일사)02-02] 문화를 이해하는 다양한 관점을 비교하고, 자신의 관점을 성찰한다." },
                        "[9사(일사)02-03]": { standard: "[9사(일사)02-03] 여러 집단에서 나타나는 다양한 문화 사례들을 조사하고, 문화를 이해하는 바람직한 태도에 대하여 토의한다." },
                        "[9사(일사)02-04]": { standard: "[9사(일사)02-04] 현대사회의 다양한 문화 변동 양상을 탐색하고, 전통문화의 가치를 성찰한다." },
                    },
                    "(3) 정치": {
                        "[9사(일사)03-01]": { standard: "[9사(일사)03-01] 정치의 의미와 기능을 이해하고, 정치와 일상생활의 관계를 탐색한다." },
                        "[9사(일사)03-02]": { standard: "[9사(일사)03-02] 민주주의의 이념과 기본 원리를 이해하고, 이를 실현하기 위한 제도와 시민의 역할을 탐구한다." },
                        "[9사(일사)03-03]": { standard: "[9사(일사)03-03] 현대 민주주의의 특징과 과제를 검토하고, 우리나라 민주주의의 발전을 위한 제도적 방안과 시민의 역할에 대해 토의한다." },
                    },
                    "(4) 법": {
                        "[9사(일사)04-01]": { standard: "[9사(일사)04-01] 법의 의미와 목적을 이해하고, 다양한 법의 종류와 특징을 비교한다." },
                        "[9사(일사)04-02]": { standard: "[9사(일사)04-02] 인권의 의미와 중요성을 이해하고, 인권 보장을 위한 헌법상의 기본 원리와 제도를 탐구한다." },
                        "[9사(일사)04-03]": { standard: "[9사(일사)04-03] 재판의 의미와 종류를 설명하고, 공정한 재판의 중요성에 대해 토의한다." },
                    },
                    "(5) 경제": {
                        "[9사(일사)05-01]": { standard: "[9사(일사)05-01] 경제생활에서 합리적 선택의 필요성에 대해 검토하고, 비용과 편익을 고려한 합리적 선택 방안을 탐색한다." },
                        "[9사(일사)05-02]": { standard: "[9사(일사)05-02] 시장 경제의 특징을 이해하고, 시장 가격의 결정과 변동 원리를 분석한다." },
                        "[9사(일사)05-03]": { standard: "[9사(일사)05-03] 시장경제에서 기업의 역할과 사회적 책임을 설명하고, 우리 사회에 필요한 기업가 정신에 대해 토의한다." }
                    }
                },
                "역사": {
                    "I. 문명의 형성과 고대 세계의 발전": {
                        "[9역01-01]": { standard: "[9역01-01] 인류의 출현과 선사 문화의 전개 과정을 이해하고, 문명의 발생과 고대 국가의 성립 과정을 탐구한다." },
                        "[9역01-02]": { standard: "[9역01-02] 고대 동아시아 여러 나라의 건국과 발전 과정을 비교하고, 각국의 특징을 설명한다." },
                        "[9역01-03]": { standard: "[9역01-03] 고대 서아시아와 지중해 세계의 정치적 변동 및 문화적 특징을 탐색한다." }
                    },
                    "II. 동아시아 세계의 형성과 변화": {
                        "[9역02-01]": { standard: "[9역02-01] 삼국의 성장과 상호 관계를 파악하고, 통일 과정을 이해한다." },
                        "[9역02-02]": { standard: "[9역02-02] 남북국 시대의 정치·사회적 변화를 파악한다." },
                        "[9역02-03]": { standard: "[9역02-03] 고려의 건국과 후삼국 통일 과정을 이해하고, 고려 초기의 통치 체제 정비 노력을 설명한다." },
                        "[9역02-04]": { standard: "[9역02-04] 고려 시대 대외 관계의 특징과 변천 과정을 파악하고, 무신정권의 성립과 민중의 저항을 탐구한다." },
                        "[9역02-05]": { standard: "[9역02-05] 원 간섭기 고려 사회의 변화상을 파악하고, 공민왕의 개혁 정치를 이해한다." }
                    },
                    "III. 조선의 성립과 발전": {
                        "[9역03-01]":
